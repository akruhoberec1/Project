create database hoteldb;

create table Person(
Id uuid primary key,
FirstName varchar (50) not null,
LastName varchar (50) not null,
OIB numeric not null
);

alter table Person alter column OIB type varchar (11);

create table Employee(
Id uuid primary key,
Salary numeric (15,6) not null,
Certified bool,
SuperiorEmployeeId uuid,
constraint FK_Person_Employee_Id foreign key(Id) references Person(Id) on delete cascade,
constraint fk_Employee_Employee_Id foreign key(SuperiorEmployeeId) references Employee(Id) on delete cascade
);

create table Guest(
Id uuid primary key,
Email varchar not null,
Phone numeric not null,
constraint FK_Person_Guest_Id foreign key(Id) references Person(Id) on delete cascade
);

create table RoomType(
Id uuid primary key,
RoomType varchar not null,
RoomPrice numeric(15,6) not null
);

create table Room(
Id uuid primary key,
RoomNumber int not null check (RoomNumber <= 4),
RoomTypeId uuid not null,
constraint FK_RoomType_Room_Id foreign key(RoomTypeId) references RoomType(Id)
);

create table GuestRoom(
GuestId uuid primary key,
RoomId uuid not null,
constraint FK_Room_GuestRoom_RoomId foreign key(GuestId) references Guest(Id),
constraint FK_Guest_GuestRoom_GuestId foreign key(RoomId) references Room(Id)
);

create table PaymentDetails(
Id uuid primary key,
PaymentMethod varchar(50) not null,
CardNo numeric
);


create table Reservation(
Id uuid primary key,
RoomId uuid not null,
GuestId uuid not null,
PaymentDetailsId uuid not null,
ArrivalDate date not null default current_date,
DepartureDate date not null,
constraint FK_PaymentDetails_Reservation_PaymentDetailsId foreign key(PaymentDetailsId) references PaymentDetails(Id),
constraint FK_Room_Reservation_RoomId foreign key(RoomId) references Room(Id),
constraint FK_Guest_Reservation_GuestId foreign key(GuestId) references Guest(Id)
);


insert into Person (Id, FirstName, LastName, OIB) values 
('05227288-c656-4ff3-8a68-143b08df8464','Andrija', 'Kruhoberec',12387654325);
/*('Branimir', 'Križanec', 45863217845),
('Filip','Todorović',12365897561),
('Bruno','Denisov',65874589674),
('Tihomir','Rečić',68954215945),
('Patricija','Pernar',45872154689),
('Monika','Tankosić',14587965874),
('Lovre','Mažuran',78945521213),
('Germa','Tiesto',12354986521),
('Paško','Patak',15862345873),
('Patak','Tvrdica',12365874951);*/


select * from person;
select * from employee e;
